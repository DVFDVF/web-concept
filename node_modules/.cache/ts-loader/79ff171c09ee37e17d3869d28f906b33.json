{"remainingRequest":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/babel-loader/lib/index.js!/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/ts-loader/index.js??ref--15-2!/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/concept/fury-client/src/manager/token.ts","dependencies":[{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/src/manager/token.ts","mtime":1716171553014},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/babel.config.js","mtime":1716171552917},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/cache-loader/dist/cjs.js","mtime":1716171608994},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/babel-loader/lib/index.js","mtime":1716171609486},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/ts-loader/index.js","mtime":1716171609531},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js","mtime":1716171609105}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGNvbm4gZnJvbSAnLi9jb25uJzsKaW1wb3J0IHsgVE9LRU5fS0VZLCBGUkVTSF9UT0tFTl9LRVkgfSBmcm9tICcuL2NvbnN0JzsKY2xhc3MgVG9rZW5Db250cm9sbGVyIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHRoaXMudG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9LRVkpOwogICAgdGhpcy5mcmVzaFRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oRlJFU0hfVE9LRU5fS0VZKTsKICB9CiAgdXBkYXRlVG9rZW4odmFsdWUpIHsKICAgIGlmICh0aGlzLnRva2VuID09PSB2YWx1ZSkgewogICAgICByZXR1cm47CiAgICB9CiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShUT0tFTl9LRVksIHZhbHVlKTsKICAgIHRoaXMudG9rZW4gPSB2YWx1ZTsKICAgIC8vIOacieeUqOaIt+S/oeaBr+Wwsei/nuaOpe+8jOayoeaciXRva2Vu5L+h5oGv5bCx5YWz6ZetCiAgICBpZiAodmFsdWUpIHsKICAgICAgY29ubi5jb25uZWN0KHZhbHVlKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbm4uY2xvc2UoKTsKICAgIH0KICB9CiAgdXBkYXRlRnJlc2hUb2tlbih2YWx1ZSkgewogICAgaWYgKHRoaXMuZnJlc2hUb2tlbiAhPT0gdmFsdWUpIHsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oRlJFU0hfVE9LRU5fS0VZLCB2YWx1ZSk7CiAgICAgIHRoaXMuZnJlc2hUb2tlbiA9IHZhbHVlOwogICAgfQogIH0KICB1cGRhdGUodG9rZW4sIGZyZXNoVG9rZW4pIHsKICAgIHRoaXMudXBkYXRlVG9rZW4odG9rZW4pOwogICAgaWYgKHRoaXMuZnJlc2hUb2tlbiAhPT0gZnJlc2hUb2tlbikgewogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShGUkVTSF9UT0tFTl9LRVksIGZyZXNoVG9rZW4pOwogICAgICB0aGlzLmZyZXNoVG9rZW4gPSBmcmVzaFRva2VuOwogICAgfQogIH0KfQpleHBvcnQgY29uc3QgdG9rZW5Db250cm9sbGVyID0gbmV3IFRva2VuQ29udHJvbGxlcigpOw=="},{"version":3,"names":["conn","TOKEN_KEY","FRESH_TOKEN_KEY","TokenController","constructor","token","localStorage","getItem","freshToken","updateToken","value","setItem","connect","close","updateFreshToken","update","tokenController"],"sources":["/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/concept/fury-client/src/manager/token.ts"],"sourcesContent":["import conn from './conn';\nimport { TOKEN_KEY, FRESH_TOKEN_KEY } from './const';\nclass TokenController {\n  token: string | null;\n  freshToken: string | null;\n  constructor() {\n    this.token = localStorage.getItem(TOKEN_KEY);\n    this.freshToken = localStorage.getItem(FRESH_TOKEN_KEY);\n  }\n  updateToken(value: string) {\n    if (this.token === value) {\n      return;\n    }\n    localStorage.setItem(TOKEN_KEY, value);\n    this.token = value;\n    // 有用户信息就连接，没有token信息就关闭\n    if (value) {\n      conn.connect(value);\n    } else {\n      conn.close();\n    }\n  }\n  updateFreshToken(value: string) {\n    if (this.freshToken !== value) {\n      localStorage.setItem(FRESH_TOKEN_KEY, value);\n      this.freshToken = value;\n    }\n  }\n  update(token: string, freshToken: string) {\n    this.updateToken(token);\n    if (this.freshToken !== freshToken) {\n      localStorage.setItem(FRESH_TOKEN_KEY, freshToken);\n      this.freshToken = freshToken;\n    }\n  }\n}\n\nexport const tokenController = new TokenController();\n"],"mappings":"AAAA,OAAOA,IAAI,MAAM,QAAQ;AACzB,SAASC,SAAS,EAAEC,eAAe,QAAQ,SAAS;AACpD,MAAMC,eAAe;EAGnBC,YAAA;IACE,IAAI,CAACC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAACN,SAAS,CAAC;IAC5C,IAAI,CAACO,UAAU,GAAGF,YAAY,CAACC,OAAO,CAACL,eAAe,CAAC;EACzD;EACAO,WAAWA,CAACC,KAAa;IACvB,IAAI,IAAI,CAACL,KAAK,KAAKK,KAAK,EAAE;MACxB;;IAEFJ,YAAY,CAACK,OAAO,CAACV,SAAS,EAAES,KAAK,CAAC;IACtC,IAAI,CAACL,KAAK,GAAGK,KAAK;IAClB;IACA,IAAIA,KAAK,EAAE;MACTV,IAAI,CAACY,OAAO,CAACF,KAAK,CAAC;KACpB,MAAM;MACLV,IAAI,CAACa,KAAK,EAAE;;EAEhB;EACAC,gBAAgBA,CAACJ,KAAa;IAC5B,IAAI,IAAI,CAACF,UAAU,KAAKE,KAAK,EAAE;MAC7BJ,YAAY,CAACK,OAAO,CAACT,eAAe,EAAEQ,KAAK,CAAC;MAC5C,IAAI,CAACF,UAAU,GAAGE,KAAK;;EAE3B;EACAK,MAAMA,CAACV,KAAa,EAAEG,UAAkB;IACtC,IAAI,CAACC,WAAW,CAACJ,KAAK,CAAC;IACvB,IAAI,IAAI,CAACG,UAAU,KAAKA,UAAU,EAAE;MAClCF,YAAY,CAACK,OAAO,CAACT,eAAe,EAAEM,UAAU,CAAC;MACjD,IAAI,CAACA,UAAU,GAAGA,UAAU;;EAEhC;;AAGF,OAAO,MAAMQ,eAAe,GAAG,IAAIb,eAAe,EAAE"}]}