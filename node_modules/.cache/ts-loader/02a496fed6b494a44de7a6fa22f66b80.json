{"remainingRequest":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/babel-loader/lib/index.js!/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/ts-loader/index.js??ref--15-2!/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/concept/fury-client/src/views/reentryReward/index.ts","dependencies":[{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/src/views/reentryReward/index.ts","mtime":1718693632271},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/babel.config.js","mtime":1716171552917},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/cache-loader/dist/cjs.js","mtime":1716171608994},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/babel-loader/lib/index.js","mtime":1716171609486},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/ts-loader/index.js","mtime":1716171609531},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js","mtime":1716171609105}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IHJlYWN0aXZlLCByZWYgfSBmcm9tICd2dWUnOwppbXBvcnQgeyBnZXRSZWNoYXJnZVJld2FyZCB9IGZyb20gJy4vYXBpJzsKaW1wb3J0IGRhdGFDZW50ZXIgZnJvbSAnQC9kYXRhQ2VudGVyJzsKaW1wb3J0IGRheWpzIGZyb20gJ2RheWpzJzsKY2xhc3MgUmVlbnRyeVJld2FyZCB7CiAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLmFjdGl2ZSA9IHJlZihmYWxzZSk7CiAgICB0aGlzLmRpZmYgPSByZWYoJycpOwogICAgdGhpcy5zZWxlY3RlZCA9IC0xOwogICAgdGhpcy50aW1lciA9IDA7CiAgICB0aGlzLmNvbmZpZ3VyYXRpb25UaW1lciA9IDA7CiAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICB0aGlzLnNldEFjdGl2ZSgpOwogICAgfSwgMTAwMCk7CiAgICB0aGlzLmNvbmZpZ3VyYXRpb25UaW1lciA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgLy/mr4/liIbpkp/mm7TmlrDphY3nva4KICAgICAgaWYgKCF0aGlzLmFjdGl2ZS52YWx1ZSB8fCAhZGF0YUNlbnRlci51c2VyLmRhdGEpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgcmVlbnRyeVJld2FyZC5nZXRDb25maWd1cmF0aW9uKCk7CiAgICB9LCAxMDAwMCk7CiAgfQogIGRlc3Ryb3koKSB7CiAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpOwogICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNvbmZpZ3VyYXRpb25UaW1lcik7CiAgfQogIGdldENvbmZpZ3VyYXRpb24oKSB7CiAgICBnZXRSZWNoYXJnZVJld2FyZCgpLnRoZW4ocmVzcCA9PiB7CiAgICAgIGlmICghcmVzcCkgewogICAgICAgIHRoaXMuY29uZmlndXJhdGlvbiA9IHVuZGVmaW5lZDsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5jb25maWd1cmF0aW9uID0gcmVzcDsKICAgICAgaWYgKHRoaXMuY29uZmlndXJhdGlvbi5leHBpcmVUaW1lKSB7CiAgICAgICAgdGhpcy50aW1lID0gZGF5anMoYCR7dGhpcy5jb25maWd1cmF0aW9uLmV4cGlyZVRpbWV9WmApOwogICAgICB9CiAgICB9KTsKICB9CiAgc2V0QWN0aXZlKCkgewogICAgdmFyIF90aGlzJGNvbmZpZ3VyYXRpb247CiAgICBpZiAoKF90aGlzJGNvbmZpZ3VyYXRpb24gPSB0aGlzLmNvbmZpZ3VyYXRpb24pICE9PSBudWxsICYmIF90aGlzJGNvbmZpZ3VyYXRpb24gIT09IHZvaWQgMCAmJiBfdGhpcyRjb25maWd1cmF0aW9uLmV4cGlyZVRpbWUpIHsKICAgICAgaWYgKHRoaXMudGltZSkgewogICAgICAgIHRoaXMuYWN0aXZlLnZhbHVlID0gZGF5anMoKS5pc0JlZm9yZSh0aGlzLnRpbWUpOwogICAgICAgIC8vIOS9v+eUqGZvcm1hdOaWueazleWwhuavq+enkui9rOaNouS4uuaXtuWIhuenkueahOagvOW8jwogICAgICAgIHRoaXMuZGlmZi52YWx1ZSA9IGRheWpzLmR1cmF0aW9uKHRoaXMudGltZS5kaWZmKGRheWpzKCkpKS5mb3JtYXQoJ0RELUhIOm1tOnNzJyk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuYWN0aXZlLnZhbHVlID0gZmFsc2U7CiAgICB9CiAgfQogIGZpbHRyYXRlKGl0ZW1zKSB7CiAgICB2YXIgX3RoaXMkY29uZmlndXJhdGlvbjI7CiAgICBpZiAoKF90aGlzJGNvbmZpZ3VyYXRpb24yID0gdGhpcy5jb25maWd1cmF0aW9uKSAhPT0gbnVsbCAmJiBfdGhpcyRjb25maWd1cmF0aW9uMiAhPT0gdm9pZCAwICYmIF90aGlzJGNvbmZpZ3VyYXRpb24yLmNvbmZpZykgewogICAgICBjb25zdCBjb25maWcgPSB0aGlzLmNvbmZpZ3VyYXRpb24uY29uZmlnOwogICAgICBjb25zdCByZXN1bHRBcnJheSA9IGNvbmZpZy5jb25jYXQoaXRlbXMpLnJlZHVjZSgoYWNjLCBjdXJyZW50KSA9PiB7CiAgICAgICAgaWYgKCFhY2MuZmluZChpdGVtID0+IGl0ZW0uaW5pdGlhbFZhbHVlID09PSBjdXJyZW50LmluaXRpYWxWYWx1ZSkpIHsKICAgICAgICAgIGFjYy5wdXNoKGN1cnJlbnQpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYWNjOwogICAgICB9LCBbXSk7CiAgICAgIHJlc3VsdEFycmF5LnNvcnQoKGEsIGIpID0+IGEuaW5pdGlhbFZhbHVlIC0gYi5pbml0aWFsVmFsdWUpOwogICAgICByZXR1cm4gcmVzdWx0QXJyYXk7CiAgICB9CiAgICByZXR1cm4gaXRlbXM7CiAgfQp9CmV4cG9ydCBjb25zdCByZWVudHJ5UmV3YXJkID0gcmVhY3RpdmUobmV3IFJlZW50cnlSZXdhcmQoKSk7"},{"version":3,"names":["reactive","ref","getRechargeReward","dataCenter","dayjs","ReentryReward","constructor","active","diff","selected","timer","configurationTimer","setInterval","setActive","value","user","data","reentryReward","getConfiguration","destroy","clearInterval","then","resp","configuration","undefined","expireTime","time","_this$configuration","isBefore","duration","format","filtrate","items","_this$configuration2","config","resultArray","concat","reduce","acc","current","find","item","initialValue","push","sort","a","b"],"sources":["/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/concept/fury-client/src/views/reentryReward/index.ts"],"sourcesContent":["import { reactive, ref } from 'vue';\nimport { getRechargeReward } from './api';\nimport { GetRechargeRewardResp } from './api/protocol';\nimport dataCenter from '@/dataCenter';\nimport dayjs from 'dayjs';\nimport { RewardItem } from '../home/api/wallet-api/walletProtocol';\n\nclass ReentryReward {\n  public active = ref(false);\n  public configuration: GetRechargeRewardResp | undefined;\n  public time: dayjs.Dayjs | undefined;\n  public diff = ref('');\n  public selected = -1;\n  private timer = 0;\n  private configurationTimer = 0;\n  constructor() {\n    this.timer = setInterval(() => {\n      this.setActive();\n    }, 1000);\n    this.configurationTimer = setInterval(() => {\n      //每分钟更新配置\n      if (!this.active.value || !dataCenter.user.data) {\n        return;\n      }\n      reentryReward.getConfiguration();\n    }, 10000);\n  }\n  destroy() {\n    clearInterval(this.timer);\n    clearInterval(this.configurationTimer);\n  }\n  getConfiguration() {\n    getRechargeReward().then((resp) => {\n      if (!resp) {\n        this.configuration = undefined;\n        return;\n      }\n      this.configuration = resp;\n      if (this.configuration.expireTime) {\n        this.time = dayjs(`${this.configuration.expireTime}Z`);\n      }\n    });\n  }\n  setActive() {\n    if (this.configuration?.expireTime) {\n      if (this.time) {\n        this.active.value = dayjs().isBefore(this.time);\n        // 使用format方法将毫秒转换为时分秒的格式\n        this.diff.value = dayjs\n          .duration(this.time.diff(dayjs()))\n          .format('DD-HH:mm:ss');\n      }\n    } else {\n      this.active.value = false;\n    }\n  }\n\n  filtrate(items: RewardItem[]) {\n    if (this.configuration?.config) {\n      const config = this.configuration.config as RewardItem[];\n      const resultArray = config\n        .concat(items)\n        .reduce((acc: RewardItem[], current) => {\n          if (!acc.find((item) => item.initialValue === current.initialValue)) {\n            acc.push(current);\n          }\n          return acc;\n        }, []);\n      resultArray.sort((a, b) => a.initialValue - b.initialValue);\n      return resultArray;\n    }\n    return items;\n  }\n}\n\nexport const reentryReward = reactive(new ReentryReward());\n"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,GAAG,QAAQ,KAAK;AACnC,SAASC,iBAAiB,QAAQ,OAAO;AAEzC,OAAOC,UAAU,MAAM,cAAc;AACrC,OAAOC,KAAK,MAAM,OAAO;AAGzB,MAAMC,aAAa;EAQjBC,YAAA;IAPO,KAAAC,MAAM,GAAGN,GAAG,CAAC,KAAK,CAAC;IAGnB,KAAAO,IAAI,GAAGP,GAAG,CAAC,EAAE,CAAC;IACd,KAAAQ,QAAQ,GAAG,CAAC,CAAC;IACZ,KAAAC,KAAK,GAAG,CAAC;IACT,KAAAC,kBAAkB,GAAG,CAAC;IAE5B,IAAI,CAACD,KAAK,GAAGE,WAAW,CAAC,MAAK;MAC5B,IAAI,CAACC,SAAS,EAAE;IAClB,CAAC,EAAE,IAAI,CAAC;IACR,IAAI,CAACF,kBAAkB,GAAGC,WAAW,CAAC,MAAK;MACzC;MACA,IAAI,CAAC,IAAI,CAACL,MAAM,CAACO,KAAK,IAAI,CAACX,UAAU,CAACY,IAAI,CAACC,IAAI,EAAE;QAC/C;;MAEFC,aAAa,CAACC,gBAAgB,EAAE;IAClC,CAAC,EAAE,KAAK,CAAC;EACX;EACAC,OAAOA,CAAA;IACLC,aAAa,CAAC,IAAI,CAACV,KAAK,CAAC;IACzBU,aAAa,CAAC,IAAI,CAACT,kBAAkB,CAAC;EACxC;EACAO,gBAAgBA,CAAA;IACdhB,iBAAiB,EAAE,CAACmB,IAAI,CAAEC,IAAI,IAAI;MAChC,IAAI,CAACA,IAAI,EAAE;QACT,IAAI,CAACC,aAAa,GAAGC,SAAS;QAC9B;;MAEF,IAAI,CAACD,aAAa,GAAGD,IAAI;MACzB,IAAI,IAAI,CAACC,aAAa,CAACE,UAAU,EAAE;QACjC,IAAI,CAACC,IAAI,GAAGtB,KAAK,CAAC,GAAG,IAAI,CAACmB,aAAa,CAACE,UAAU,GAAG,CAAC;;IAE1D,CAAC,CAAC;EACJ;EACAZ,SAASA,CAAA;IAAA,IAAAc,mBAAA;IACP,KAAAA,mBAAA,GAAI,IAAI,CAACJ,aAAa,cAAAI,mBAAA,eAAlBA,mBAAA,CAAoBF,UAAU,EAAE;MAClC,IAAI,IAAI,CAACC,IAAI,EAAE;QACb,IAAI,CAACnB,MAAM,CAACO,KAAK,GAAGV,KAAK,EAAE,CAACwB,QAAQ,CAAC,IAAI,CAACF,IAAI,CAAC;QAC/C;QACA,IAAI,CAAClB,IAAI,CAACM,KAAK,GAAGV,KAAK,CACpByB,QAAQ,CAAC,IAAI,CAACH,IAAI,CAAClB,IAAI,CAACJ,KAAK,EAAE,CAAC,CAAC,CACjC0B,MAAM,CAAC,aAAa,CAAC;;KAE3B,MAAM;MACL,IAAI,CAACvB,MAAM,CAACO,KAAK,GAAG,KAAK;;EAE7B;EAEAiB,QAAQA,CAACC,KAAmB;IAAA,IAAAC,oBAAA;IAC1B,KAAAA,oBAAA,GAAI,IAAI,CAACV,aAAa,cAAAU,oBAAA,eAAlBA,oBAAA,CAAoBC,MAAM,EAAE;MAC9B,MAAMA,MAAM,GAAG,IAAI,CAACX,aAAa,CAACW,MAAsB;MACxD,MAAMC,WAAW,GAAGD,MAAM,CACvBE,MAAM,CAACJ,KAAK,CAAC,CACbK,MAAM,CAAC,CAACC,GAAiB,EAAEC,OAAO,KAAI;QACrC,IAAI,CAACD,GAAG,CAACE,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACC,YAAY,KAAKH,OAAO,CAACG,YAAY,CAAC,EAAE;UACnEJ,GAAG,CAACK,IAAI,CAACJ,OAAO,CAAC;;QAEnB,OAAOD,GAAG;MACZ,CAAC,EAAE,EAAE,CAAC;MACRH,WAAW,CAACS,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACH,YAAY,GAAGI,CAAC,CAACJ,YAAY,CAAC;MAC3D,OAAOP,WAAW;;IAEpB,OAAOH,KAAK;EACd;;AAGF,OAAO,MAAMf,aAAa,GAAGjB,QAAQ,CAAC,IAAIK,aAAa,EAAE,CAAC"}]}