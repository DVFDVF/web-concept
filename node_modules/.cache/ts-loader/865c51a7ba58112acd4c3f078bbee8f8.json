{"remainingRequest":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/babel-loader/lib/index.js!/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/ts-loader/index.js??ref--15-2!/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/concept/fury-client/src/dataCenter/user.ts","dependencies":[{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/src/dataCenter/user.ts","mtime":1716171553009},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/babel.config.js","mtime":1716171552917},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/cache-loader/dist/cjs.js","mtime":1716171608994},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/babel-loader/lib/index.js","mtime":1716171609486},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/ts-loader/index.js","mtime":1716171609531},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js","mtime":1716171609105}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGNvbm4sIHsgQ29ubk1vZGFsIH0gZnJvbSAnQC9tYW5hZ2VyL2Nvbm4nOwppbXBvcnQgeyByZWFjdGl2ZSB9IGZyb20gJ3Z1ZSc7CmltcG9ydCBkYXRhQ2VudGVyIGZyb20gJy4nOwpjbGFzcyBVc2VyIHsKICB1cGRhdGUodXNlcikgewogICAgdGhpcy5kYXRhID0gdXNlcjsKICB9CiAgc3RhcnRMaXN0ZW4oKSB7CiAgICBjb25uLmFkZExpc3RlbmVyKENvbm5Nb2RhbC5TMkNfRVhQRVJJRU5DRSwgdGhpcyk7CiAgfQogIHN0b3BMaXN0ZW4oKSB7CiAgICBjb25uLnJlbW92ZUxpc3RlbmVyKENvbm5Nb2RhbC5TMkNfRVhQRVJJRU5DRSwgdGhpcyk7CiAgfQogIC8qKue7j+mqjOW5v+aSrSAqLwogIG9uRGF0YShleHBlcmllbmNlRGF0YSkgewogICAgdGhpcy51c2VyRXhwZXJpZW5jZURhdGEgPSBleHBlcmllbmNlRGF0YTsKICAgIGlmICh0aGlzLmRhdGEpIHsKICAgICAgdGhpcy5kYXRhLmV4cCA9IHRoaXMudXNlckV4cGVyaWVuY2VEYXRhLmV4cDsKICAgIH0KICAgIC8v6I635Y+W57uP6aqM5ZCO5pu05paw562J57qnCiAgICB0aGlzLnVwZGF0YUxldmVsKCk7CiAgfQogIC8qKuiOt+WPluetiee6pyAqLwogIHVwZGF0YUxldmVsKCkgewogICAgaWYgKHRoaXMuZGF0YSkgewogICAgICBjb25zdCBsZXZlbENvbmZpZ3MgPSBkYXRhQ2VudGVyLndlYkNvbmZpZy5sZXZlbENvbmZpZ3M7CiAgICAgIGZvciAoY29uc3QgbGV2ZWxEYXRhIG9mIGxldmVsQ29uZmlncykgewogICAgICAgIGlmICh0aGlzLmRhdGEuZXhwIDwgbGV2ZWxEYXRhLmNoaXApIHsKICAgICAgICAgIHRoaXMuZGF0YS5sZXZlbCA9IGxldmVsRGF0YS5sZXZlbCAtIDE7CiAgICAgICAgfQogICAgICB9CiAgICAgIC8vIOWmguaenOe7j+mqjOWAvOmrmOS6juaVsOe7hOS4reeahOacgOmrmOWAvO+8jOi/lOWbnuaVsOe7hOS4reeahOacgOWQjuS4gOS4quetiee6pwogICAgICB0aGlzLmRhdGEubGV2ZWwgPSBsZXZlbENvbmZpZ3NbbGV2ZWxDb25maWdzLmxlbmd0aCAtIDFdLmxldmVsOwogICAgfQogIH0KICAvKirmt7vliqDnu4/pqowgKi8KICBhZGRFeHBlcmllbmNlKGV4cGVyaWVuY2UpIHsKICAgIGlmICh0aGlzLmRhdGEpIHsKICAgICAgdGhpcy5kYXRhLmV4cCArPSBleHBlcmllbmNlOwogICAgICAvL+iOt+WPlua3u+WKoOe7j+mqjOWQjuabtOaWsOetiee6pwogICAgICB0aGlzLnVwZGF0YUxldmVsKCk7CiAgICB9CiAgfQp9CmV4cG9ydCBjb25zdCB1c2VyID0gcmVhY3RpdmUobmV3IFVzZXIoKSk7CnVzZXIuc3RhcnRMaXN0ZW4oKTs="},{"version":3,"names":["conn","ConnModal","reactive","dataCenter","User","update","user","data","startListen","addListener","S2C_EXPERIENCE","stopListen","removeListener","onData","experienceData","userExperienceData","exp","updataLevel","levelConfigs","webConfig","levelData","chip","level","length","addExperience","experience"],"sources":["/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/concept/fury-client/src/dataCenter/user.ts"],"sourcesContent":["import { AutoLoginResp } from '@/api/protocol';\nimport conn, { ConnModal, IConnectionListener } from '@/manager/conn';\nimport { reactive } from 'vue';\nimport dataCenter from '.';\nexport interface UserExperienceData {\n  // todo 定义数据结构\n  cashBack: number;\n  exp: number;\n  level: number;\n  userId: number;\n}\ntype UserState = Omit<AutoLoginResp, 'token'>;\nclass User implements IConnectionListener<UserExperienceData> {\n  data?: UserState;\n  userExperienceData?: UserExperienceData;\n  update(user?: UserState) {\n    this.data = user;\n  }\n  startListen() {\n    conn.addListener(ConnModal.S2C_EXPERIENCE, this);\n  }\n  stopListen() {\n    conn.removeListener(ConnModal.S2C_EXPERIENCE, this);\n  }\n\n  /**经验广播 */\n  onData(experienceData: UserExperienceData) {\n    this.userExperienceData = experienceData;\n    if (this.data) {\n      this.data.exp = this.userExperienceData.exp;\n    }\n    //获取经验后更新等级\n    this.updataLevel();\n  }\n  /**获取等级 */\n  updataLevel() {\n    if (this.data) {\n      const levelConfigs = dataCenter.webConfig.levelConfigs;\n      for (const levelData of levelConfigs) {\n        if (this.data.exp < levelData.chip) {\n          this.data.level = levelData.level - 1;\n        }\n      }\n      // 如果经验值高于数组中的最高值，返回数组中的最后一个等级\n      this.data.level = levelConfigs[levelConfigs.length - 1].level;\n    }\n  }\n  /**添加经验 */\n  addExperience(experience: number) {\n    if (this.data) {\n      this.data.exp += experience;\n      //获取添加经验后更新等级\n      this.updataLevel();\n    }\n  }\n}\n\nexport const user = reactive(new User());\nuser.startListen();\n"],"mappings":"AACA,OAAOA,IAAI,IAAIC,SAAS,QAA6B,gBAAgB;AACrE,SAASC,QAAQ,QAAQ,KAAK;AAC9B,OAAOC,UAAU,MAAM,GAAG;AAS1B,MAAMC,IAAI;EAGRC,MAAMA,CAACC,IAAgB;IACrB,IAAI,CAACC,IAAI,GAAGD,IAAI;EAClB;EACAE,WAAWA,CAAA;IACTR,IAAI,CAACS,WAAW,CAACR,SAAS,CAACS,cAAc,EAAE,IAAI,CAAC;EAClD;EACAC,UAAUA,CAAA;IACRX,IAAI,CAACY,cAAc,CAACX,SAAS,CAACS,cAAc,EAAE,IAAI,CAAC;EACrD;EAEA;EACAG,MAAMA,CAACC,cAAkC;IACvC,IAAI,CAACC,kBAAkB,GAAGD,cAAc;IACxC,IAAI,IAAI,CAACP,IAAI,EAAE;MACb,IAAI,CAACA,IAAI,CAACS,GAAG,GAAG,IAAI,CAACD,kBAAkB,CAACC,GAAG;;IAE7C;IACA,IAAI,CAACC,WAAW,EAAE;EACpB;EACA;EACAA,WAAWA,CAAA;IACT,IAAI,IAAI,CAACV,IAAI,EAAE;MACb,MAAMW,YAAY,GAAGf,UAAU,CAACgB,SAAS,CAACD,YAAY;MACtD,KAAK,MAAME,SAAS,IAAIF,YAAY,EAAE;QACpC,IAAI,IAAI,CAACX,IAAI,CAACS,GAAG,GAAGI,SAAS,CAACC,IAAI,EAAE;UAClC,IAAI,CAACd,IAAI,CAACe,KAAK,GAAGF,SAAS,CAACE,KAAK,GAAG,CAAC;;;MAGzC;MACA,IAAI,CAACf,IAAI,CAACe,KAAK,GAAGJ,YAAY,CAACA,YAAY,CAACK,MAAM,GAAG,CAAC,CAAC,CAACD,KAAK;;EAEjE;EACA;EACAE,aAAaA,CAACC,UAAkB;IAC9B,IAAI,IAAI,CAAClB,IAAI,EAAE;MACb,IAAI,CAACA,IAAI,CAACS,GAAG,IAAIS,UAAU;MAC3B;MACA,IAAI,CAACR,WAAW,EAAE;;EAEtB;;AAGF,OAAO,MAAMX,IAAI,GAAGJ,QAAQ,CAAC,IAAIE,IAAI,EAAE,CAAC;AACxCE,IAAI,CAACE,WAAW,EAAE"}]}