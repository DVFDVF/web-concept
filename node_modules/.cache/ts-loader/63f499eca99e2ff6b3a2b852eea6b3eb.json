{"remainingRequest":"/Users/nuomi/Desktop/项目/concept/web3-concept/node_modules/babel-loader/lib/index.js!/Users/nuomi/Desktop/项目/concept/web3-concept/node_modules/ts-loader/index.js??ref--15-2!/Users/nuomi/Desktop/项目/concept/web3-concept/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/concept/web3-concept/src/api/index.ts","dependencies":[{"path":"/Users/nuomi/Desktop/项目/concept/web3-concept/src/api/index.ts","mtime":1716450505671},{"path":"/Users/nuomi/Desktop/项目/concept/web3-concept/babel.config.js","mtime":1716171552917},{"path":"/Users/nuomi/Desktop/项目/concept/web3-concept/node_modules/cache-loader/dist/cjs.js","mtime":1716171608994},{"path":"/Users/nuomi/Desktop/项目/concept/web3-concept/node_modules/babel-loader/lib/index.js","mtime":1716171609486},{"path":"/Users/nuomi/Desktop/项目/concept/web3-concept/node_modules/ts-loader/index.js","mtime":1716171609531},{"path":"/Users/nuomi/Desktop/项目/concept/web3-concept/node_modules/eslint-loader/index.js","mtime":1716171609105}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgeyBBcGlDb2RlIH0gZnJvbSAnQC9tYW5hZ2VyL2NvbnN0JzsKaW1wb3J0IHsgZm9yY2VSZWxvYWQsIG9wZW5Mb2dpbiB9IGZyb20gJ0AvbWFuYWdlci92aWV3JzsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHFzIGZyb20gJ3FzJzsKaW1wb3J0IHsgdG9rZW5Db250cm9sbGVyIH0gZnJvbSAnLi4vbWFuYWdlci90b2tlbic7CmltcG9ydCB7IEZSRVNIX1RPS0VOX1VSTCB9IGZyb20gJy4vcHJvdG9jb2wnOwppbXBvcnQgeyB0aXAgfSBmcm9tICdAL2NvbXBvbmVudHMvd2Fybi93YXJuJzsKaW1wb3J0IGRhdGFDZW50ZXIgZnJvbSAnQC9kYXRhQ2VudGVyJzsKY29uc3Qgc2VydmljZSA9IGF4aW9zLmNyZWF0ZSh7CiAgYmFzZVVSTDogcHJvY2Vzcy5lbnYuVlVFX0FQUF9TRVJWRVIsCiAgdGltZW91dDogMTAgKiAxMDAwLAogIGhlYWRlcnM6IHsKICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04JwogIH0KfSk7CnNlcnZpY2UuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGNvbmZpZyA9PiB7CiAgLy8g6L+Z6YeM5Y+v5Lul6K6+572udG9rZW46IGNvbmZpZyEuaGVhZGVycyEuQXV0aG9yaXphdGlvbiA9IHRva2VuCiAgY29uZmlnLmhlYWRlcnMuYXV0aCA9IHRva2VuQ29udHJvbGxlci50b2tlbjsKICBjb25maWcuaGVhZGVycy5zaWduID0gZGF0YUNlbnRlci5zaWduWzBdOwogIHJldHVybiBjb25maWc7Cn0pOwpzZXJ2aWNlLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UocmVzcG9uc2UgPT4gewogIGNvbnN0IGRhdGEgPSByZXNwb25zZS5kYXRhOwogIC8vIOiOt+WPluW9k+WJjeivt+axgueahOaOpeWPo+WcsOWdgAogIGlmIChkYXRhLmNvZGUgPT09IDIwMCkgewogICAgcmV0dXJuIGRhdGEuZGF0YTsKICB9CiAgaWYgKGRhdGEuY29kZSA9PT0gQXBpQ29kZS5VTl9BVVRIKSB7CiAgICAvL+mAgOWHuueZu+W9lQogICAgcmV0dXJuIGZyZXNoVG9rZW4oKS50aGVuKCgpID0+IHNlcnZpY2UocmVzcG9uc2UuY29uZmlnKSk7CiAgfSBlbHNlIGlmIChkYXRhLmNvZGUgPT09IEFwaUNvZGUuRlJFU0hfVE9LRU5fRVhQSVJFIHx8IGRhdGEuY29kZSA9PT0gQXBpQ29kZS5GUkVTSF9UT0tFTl9VTktOT1dOKSB7CiAgICAvLyDplb90b2tlbuW3suWkseaViAogICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCfnmbvlvZXlt7Lov4fmnJ8nKTsKICB9IGVsc2UgaWYgKGRhdGEuY29kZSA9PT0gQXBpQ29kZS5UT0tFTl9FWFBJUkVfVVBEQVRBKSB7CiAgICAvL+WmguaenOmVv3Rva2Vu5aSx5pWI5Yi35pawdG9rZW4KICAgIHRva2VuQ29udHJvbGxlci51cGRhdGVGcmVzaFRva2VuKGRhdGEuZGF0YSk7CiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ3Jlc3RhcnQnKTsKICB9IGVsc2UgewogICAgaWYgKGRhdGEuY29kZSA+IDEwMDAwKSB7CiAgICAgIGlmIChkYXRhLmNvZGUgPT0gMjAwMTYpIHsKICAgICAgICBmb3JjZVJlbG9hZCgpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOaZrumAmumUmeivr++8jOitpuWRiuaPkOmGkgogICAgICAgIHRpcC5lcnJvcihkYXRhLm1zZyk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIOS4muWKoeS4pemHjemUmeivr++8jOW8ueeql+aPkOmGkgogICAgICB0aXAuZXJyb3IoZGF0YS5tc2cpOwogICAgfQogICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGRhdGEubXNnKTsKICB9Cn0sIGVyciA9PiB7CiAgaWYgKGVyci5jb25maWcuaGVhZGVycy5hdXRvKSB7CiAgICB0aXAuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgJ+e9kee7nOW8guW4uO+8jOivt+eojeWQjumHjeivlScpOwogIH0KICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyLnJlc3BvbnNlKTsKfSk7CmxldCBmcmVzaFByb21pc2UgPSB1bmRlZmluZWQ7CmV4cG9ydCBmdW5jdGlvbiBmcmVzaFRva2VuKCkgewogIGlmICghbmF2aWdhdG9yLm9uTGluZSkgewogICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcign572R57uc5byC5bi4JykpOwogIH0KICBjb25zdCBmcmVzaFRva2VuID0gdG9rZW5Db250cm9sbGVyLmZyZXNoVG9rZW47CiAgaWYgKGZyZXNoVG9rZW4pIHsKICAgIGZyZXNoUHJvbWlzZSA9IHBvc3QoRlJFU0hfVE9LRU5fVVJMLCB7CiAgICAgIGZyZXNoVG9rZW4KICAgIH0pLnRoZW4ocmVzcCA9PiB0b2tlbkNvbnRyb2xsZXIudXBkYXRlVG9rZW4ocmVzcCkpLmNhdGNoKGVyciA9PiB7CiAgICAgIGlmIChlcnIgPT0gJ+eZu+W9leW3sui/h+acnycpIHsKICAgICAgICBvcGVuTG9naW4oKTsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCfnmbvlvZXlt7Lov4fmnJ8nKSk7CiAgICAgIH0KICAgIH0pLmZpbmFsbHkoKCkgPT4gewogICAgICBmcmVzaFByb21pc2UgPSB1bmRlZmluZWQ7CiAgICB9KTsKICAgIHJldHVybiBmcmVzaFByb21pc2U7CiAgfSBlbHNlIHsKICAgIC8vIOi3s+i9rOWIsOeZu+W9lSB0b2RvCiAgICBvcGVuTG9naW4oKTsKICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ+eZu+W9leW3sui/h+acnycpKTsKICB9Cn0KZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldCh1cmwsIHBhcmFtcywgaGVhZGVyKSB7CiAgY29uc3QgcXVlcnkgPSBwYXJhbXMgPyBxcy5zdHJpbmdpZnkocGFyYW1zKSA6IHVuZGVmaW5lZDsKICBjb25zdCBjb25uZWN0U3ltYm9sID0gdXJsLmluY2x1ZGVzKCc/JykgPyAnJicgOiAnPyc7CiAgcmV0dXJuIGF3YWl0IHNlcnZpY2UuZ2V0KHF1ZXJ5ID8gYCR7dXJsfSR7Y29ubmVjdFN5bWJvbH0ke3F1ZXJ5fWAgOiB1cmwsIGhlYWRlcik7Cn0KZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBvc3QodXJsLCBib2R5LCBoZWFkZXIpIHsKICByZXR1cm4gYXdhaXQgc2VydmljZS5wb3N0KHVybCwgYm9keSwgaGVhZGVyKTsKfQpleHBvcnQgZGVmYXVsdCBzZXJ2aWNlOw=="},{"version":3,"names":["ApiCode","forceReload","openLogin","axios","qs","tokenController","FRESH_TOKEN_URL","tip","dataCenter","service","create","baseURL","process","env","VUE_APP_SERVER","timeout","headers","interceptors","request","use","config","auth","token","sign","response","data","code","UN_AUTH","freshToken","then","FRESH_TOKEN_EXPIRE","FRESH_TOKEN_UNKNOWN","Promise","reject","TOKEN_EXPIRE_UPDATA","updateFreshToken","window","location","reload","error","msg","err","auto","message","freshPromise","undefined","navigator","onLine","Error","post","resp","updateToken","catch","finally","get","url","params","header","query","stringify","connectSymbol","includes","body"],"sources":["/Users/nuomi/Desktop/项目/concept/web3-concept/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/concept/web3-concept/src/api/index.ts"],"sourcesContent":["import { ApiCode } from '@/manager/const';\nimport { forceReload, getRouter, openLogin } from '@/manager/view';\nimport type { AxiosInstance, AxiosResponse } from 'axios';\nimport axios from 'axios';\nimport qs from 'qs';\nimport { tokenController } from '../manager/token';\nimport { FRESH_TOKEN_URL } from './protocol';\nimport { tip } from '@/components/warn/warn';\nimport dataCenter from '@/dataCenter';\n\nconst service: AxiosInstance = axios.create({\n  baseURL: process.env.VUE_APP_SERVER,\n  timeout: 10 * 1000, // 请求超时时间\n  headers: { 'Content-Type': 'application/json;charset=UTF-8' },\n});\nservice.interceptors.request.use((config) => {\n  // 这里可以设置token: config!.headers!.Authorization = token\n  config.headers.auth = tokenController.token;\n  config.headers.sign = dataCenter.sign[0];\n  return config;\n});\nservice.interceptors.response.use(\n  (response: AxiosResponse) => {\n    const data = response.data;\n\n    // 获取当前请求的接口地址\n    if (data.code === 200) {\n      return data.data;\n    }\n    if (data.code === ApiCode.UN_AUTH) {\n      //退出登录\n      return freshToken().then(() => service(response.config));\n    } else if (\n      data.code === ApiCode.FRESH_TOKEN_EXPIRE ||\n      data.code === ApiCode.FRESH_TOKEN_UNKNOWN\n    ) {\n      // 长token已失效\n      return Promise.reject('登录已过期');\n    } else if (data.code === ApiCode.TOKEN_EXPIRE_UPDATA) {\n      //如果长token失效刷新token\n      tokenController.updateFreshToken(data.data);\n      window.location.reload();\n      return Promise.reject('restart');\n    } else {\n      if (data.code > 10000) {\n        if (data.code == 20016) {\n          forceReload();\n        } else {\n          // 普通错误，警告提醒\n          tip.error(data.msg);\n        }\n      } else {\n        // 业务严重错误，弹窗提醒\n        tip.error(data.msg);\n      }\n      return Promise.reject(data.msg);\n    }\n  },\n  (err) => {\n    if (err.config.headers.auto) {\n      tip.error(err.message || '网络异常，请稍后重试');\n    }\n    return Promise.reject(err.response);\n  },\n);\n\nlet freshPromise: Promise<void> | undefined = undefined;\n\nexport function freshToken() {\n  if (!navigator.onLine) {\n    return Promise.reject(new Error('网络异常'));\n  }\n  const freshToken = tokenController.freshToken;\n  if (freshToken) {\n    freshPromise = post<string, { freshToken: string }>(FRESH_TOKEN_URL, {\n      freshToken,\n    })\n      .then((resp) => tokenController.updateToken(resp))\n      .catch((err: string) => {\n        if (err == '登录已过期') {\n          openLogin();\n          return Promise.reject(new Error('登录已过期'));\n        }\n      })\n      .finally(() => {\n        freshPromise = undefined;\n      });\n    return freshPromise;\n  } else {\n    // 跳转到登录 todo\n    openLogin();\n    return Promise.reject(new Error('登录已过期'));\n  }\n}\n\nexport async function get<R = any, T = any>(\n  url: string,\n  params?: T,\n  header?: Record<string, any>,\n): Promise<R> {\n  const query = params ? qs.stringify(params) : undefined;\n  const connectSymbol = url.includes('?') ? '&' : '?';\n  return await service.get(\n    query ? `${url}${connectSymbol}${query}` : url,\n    header,\n  );\n}\n\nexport async function post<R = any, T = any>(\n  url: string,\n  body?: T,\n  header?: Record<string, any>,\n): Promise<R> {\n  return await service.post(url, body, header);\n}\n\nexport default service;\n"],"mappings":"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"}]}