{"remainingRequest":"/Users/nuomi/Desktop/项目/fury-client/fury-client/node_modules/babel-loader/lib/index.js!/Users/nuomi/Desktop/项目/fury-client/fury-client/node_modules/ts-loader/index.js??ref--16-2!/Users/nuomi/Desktop/项目/fury-client/fury-client/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/fury-client/fury-client/src/games/limbo/game/index.tsx","dependencies":[{"path":"/Users/nuomi/Desktop/项目/fury-client/fury-client/src/games/limbo/game/index.tsx","mtime":1716171553011},{"path":"/Users/nuomi/Desktop/项目/fury-client/fury-client/babel.config.js","mtime":1716171552917},{"path":"/Users/nuomi/Desktop/项目/fury-client/fury-client/node_modules/cache-loader/dist/cjs.js","mtime":1716171608994},{"path":"/Users/nuomi/Desktop/项目/fury-client/fury-client/node_modules/babel-loader/lib/index.js","mtime":1716171609486},{"path":"/Users/nuomi/Desktop/项目/fury-client/fury-client/node_modules/ts-loader/index.js","mtime":1716171609531},{"path":"/Users/nuomi/Desktop/项目/fury-client/fury-client/node_modules/eslint-loader/index.js","mtime":1716171609105}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnOwppbXBvcnQgeyBST0xMX0RFTEFZLCBTSElQX1NDQUxFLCBWSUVXX0RFRVAgfSBmcm9tICcuL3ByZXNldCc7CmltcG9ydCB7IFN0YXJyeVNreSB9IGZyb20gJy4vU3RhcnJ5U2t5JzsKaW1wb3J0IHN0YXIgZnJvbSAnQC9hc3NldHMvZ2FtZS9saW1iby9zdGFyLnBuZyc7CmltcG9ydCBGcmFtZVNwcml0ZSBmcm9tICcuL0ZyYW1lU3ByaXRlJzsKaW1wb3J0IHNoaXBzIGZyb20gJ0AvYXNzZXRzL2dhbWUvbGltYm8vc2hpcHMucG5nJzsKaW1wb3J0IGZpcmVzIGZyb20gJ0AvYXNzZXRzL2dhbWUvbGltYm8vZmlyZXMucG5nJzsKaW1wb3J0IGZyb2cgZnJvbSAnQC9hc3NldHMvZ2FtZS9saW1iby9leHBsLnBuZyc7CmltcG9ydCBmaXJlTXAzIGZyb20gJ0AvYXNzZXRzL2dhbWUvbGltYm8vbGltYm9fZmx5Lm1wMyc7CmltcG9ydCB3aW5NcDMgZnJvbSAnQC9hc3NldHMvZ2FtZS9saW1iby9saW1ib193aW4ubXAzJzsKaW1wb3J0IGxvc2VNcDMgZnJvbSAnQC9hc3NldHMvZ2FtZS9saW1iby9sb3NpbmcubXAzJzsKaW1wb3J0IFJvbGwgZnJvbSAnLi9Sb2xsJzsKaW1wb3J0IGRhdGFDZW50ZXIgZnJvbSAnQC9kYXRhQ2VudGVyJzsKZXhwb3J0IGNsYXNzIExpbWJvIHsKICBjb25zdHJ1Y3Rvcihjb250YWluZXIpIHsKICAgIC8qKui/meS4quimgeS7juacrOWcsOeOr+Wig+ivu+WPliAqLwogICAgdGhpcy5mYXN0TW9kZSA9IGZhbHNlOwogICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7CiAgICBjb25zdCBzdGFnZVdpZHRoID0gY29udGFpbmVyLm9mZnNldFdpZHRoOwogICAgY29uc3Qgc3RhZ2VIZWlnaHQgPSBjb250YWluZXIub2Zmc2V0SGVpZ2h0OwogICAgY29uc3Qgc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKTsKICAgIGNvbnN0IGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg3NSwgc3RhZ2VXaWR0aCAvIHN0YWdlSGVpZ2h0LCAwLjEsIFZJRVdfREVFUCk7CiAgICBjYW1lcmEucG9zaXRpb24ueiA9IDU7IC8vIOWwhuebuOacuuS9jee9ruWQkeWJjeenu+WKqAogICAgY29uc3QgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7CiAgICAgIGFscGhhOiB0cnVlCiAgICB9KTsKICAgIHJlbmRlcmVyLnNldFNpemUoc3RhZ2VXaWR0aCwgc3RhZ2VIZWlnaHQpOwogICAgcmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7CiAgICBjb25zdCBzdGFnZSA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcjbGltYm8tc3RhZ2UnKTsKICAgIHN0YWdlLmFwcGVuZENoaWxkKHJlbmRlcmVyLmRvbUVsZW1lbnQpOwogICAgdGhpcy5hbmltYXRlTGF5ZXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignI2xpbWJvLWFuaW1hdGUtbGF5ZXInKTsKICAgIGNvbnN0IHN0YXJNYXRlcmlhbCA9IG5ldyBUSFJFRS5Qb2ludHNNYXRlcmlhbCh7CiAgICAgIGNvbG9yOiAweGZmZmZmZiwKICAgICAgc2l6ZTogMiwKICAgICAgbWFwOiBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpLmxvYWQoc3RhciksCiAgICAgIHRyYW5zcGFyZW50OiB0cnVlCiAgICB9KTsKICAgIHRoaXMuc3RhcnJ5U2t5ID0gbmV3IFN0YXJyeVNreShzY2VuZSwgc3Rhck1hdGVyaWFsLCAoKSA9PiB7CiAgICAgIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgY2FtZXJhKTsKICAgIH0pOwogICAgdGhpcy5hZGRTaGlwKCk7CiAgICB0aGlzLmluaXRFZmZlY3QoKTsKICAgIHRoaXMucm9sbGVyID0gbmV3IFJvbGwodGhpcy5hbmltYXRlTGF5ZXIpOwogICAgdGhpcy5zb3VuZEZpcmUgPSBuZXcgQXVkaW8oZmlyZU1wMyk7CiAgICB0aGlzLnNvdW5kRmlyZS52b2x1bWUgPSBkYXRhQ2VudGVyLmdhbWVDb25maWd1cmF0aW9uLnNvdW5kVm9sdW1lOwogICAgdGhpcy5zb3VuZFdpbiA9IG5ldyBBdWRpbyh3aW5NcDMpOwogICAgdGhpcy5zb3VuZFdpbi52b2x1bWUgPSBkYXRhQ2VudGVyLmdhbWVDb25maWd1cmF0aW9uLnNvdW5kVm9sdW1lOwogICAgdGhpcy5zb3VuZExvc2UgPSBuZXcgQXVkaW8obG9zZU1wMyk7CiAgICB0aGlzLnNvdW5kTG9zZS52b2x1bWUgPSBkYXRhQ2VudGVyLmdhbWVDb25maWd1cmF0aW9uLnNvdW5kVm9sdW1lOwogIH0KICBhZGRTaGlwKCkgewogICAgY29uc3QgYmFzZSA9IG5ldyBGcmFtZVNwcml0ZShzaGlwcywgewogICAgICB3aWR0aDogMTM4LAogICAgICBoZWlnaHQ6IDI2MiwKICAgICAgdGltZTogMTAwLAogICAgICBjb3VudDogMgogICAgfSk7CiAgICBjb25zdCBmaXJlID0gbmV3IEZyYW1lU3ByaXRlKGZpcmVzLCB7CiAgICAgIHdpZHRoOiAxMDQuMiwKICAgICAgaGVpZ2h0OiAxMDUsCiAgICAgIHRpbWU6IDUwLAogICAgICBjb3VudDogMTAsCiAgICAgIGxlZnQ6ICgxMzggLSAxMDQuMikgLyAyLAogICAgICB0b3A6IDI2MiAtIDEwNSAtIDQwCiAgICB9KTsKICAgIGNvbnN0IHNoaXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIHNoaXAuY2xhc3NOYW1lID0gJ3NoaXAnOwogICAgYmFzZS5hZGRUb1N0YWdlKHNoaXApOwogICAgZmlyZS5hZGRUb1N0YWdlKHNoaXApOwogICAgZmlyZS5yZWdpc3RlcigpOwogICAgdGhpcy5zaGlwQmFzZSA9IGJhc2U7CiAgICB0aGlzLnNoaXBGaXJlID0gZmlyZTsKICAgIHRoaXMuc2hpcEJhc2Uuc2hvd0ZyYW1lKDEpOwogICAgdGhpcy5hbmltYXRlTGF5ZXIuYXBwZW5kQ2hpbGQoc2hpcCk7CiAgICB0aGlzLnNoaXAgPSBzaGlwOwogICAgdGhpcy5yZXNldCgpOwogIH0KICBpbml0RWZmZWN0KCkgewogICAgY29uc3Qgd2lkdGggPSAzODgzIC8gMTM7CiAgICBjb25zdCBzY2FsZSA9IDAuNjsKICAgIHRoaXMuZnJvZ0VmZmVjdCA9IG5ldyBGcmFtZVNwcml0ZShmcm9nLCB7CiAgICAgIHdpZHRoLAogICAgICBoZWlnaHQ6IDMwMCwKICAgICAgdGltZTogNTAsCiAgICAgIGNvdW50OiAxMwogICAgfSk7CiAgICB0aGlzLmZyb2dFZmZlY3QuaW1nLnN0eWxlLnRyYW5zZm9ybSA9IGBzY2FsZSgke3NjYWxlfSlgOwogICAgLy8g6L+Z6YeM55u05o6l55So55qE5Zu+54mH77yM5Zu+54mH5Ly85LmO5piv5oyJ54Wn5Lit5b+D5p2l57yp5pS+55qECiAgICB0aGlzLmZyb2dFZmZlY3QuaW1nLnN0eWxlLmxlZnQgPSBgJHsodGhpcy5jb250YWluZXIub2Zmc2V0V2lkdGggLSB3aWR0aCAtIDQpIC8gMn1weGA7CiAgICB0aGlzLmZyb2dFZmZlY3QuaW1nLnN0eWxlLmJvdHRvbSA9IGAtOTBweGA7CiAgfQogIHN0YXJ0KCkgewogICAgdGhpcy5zdGFycnlTa3kucmVnaXN0ZXIoKTsKICAgIHJldHVybiB0aGlzOwogIH0KICBzdG9wKCkgewogICAgdGhpcy5zdGFycnlTa3kudW5yZWdpc3RlcigpOwogIH0KICBwbGF5RWZmZWN0KCkgewogICAgdGhpcy5hbmltYXRlTGF5ZXIuYXBwZW5kQ2hpbGQodGhpcy5mcm9nRWZmZWN0LmltZyk7CiAgICB0aGlzLmZyb2dFZmZlY3QucGxheSgxLCAoKSA9PiB7CiAgICAgIHRoaXMuZnJvZ0VmZmVjdC5pbWcucmVtb3ZlKCk7CiAgICB9KTsKICB9CiAgLyoqCiAgICoKICAgKiBAcGFyYW0gcmVzdWx0IOWQjuerr+e7meeahOe7k+aenAogICAqIEBwYXJhbSB0aHJlc2hvbGQg6I636IOc55qE6ZiI5YC8CiAgICogQHBhcmFtIG9wdGlvbiDlm57osIPnmoRvcHRpb24KICAgKi8KICBmaXJlKHJlc3VsdCwgdGhyZXNob2xkLCBvcHRpb24pIHsKICAgIGlmICh0aGlzLmZhc3RNb2RlKSB7CiAgICAgIHZhciBfb3B0aW9uJG9uRmlyZWQsIF9vcHRpb24kb25GaW5pc2hlZDsKICAgICAgdGhpcy5yb2xsZXIuZGlzcGxheShyZXN1bHQsIHRocmVzaG9sZCk7CiAgICAgIHRoaXMucm9sbGVyLnJvbGxUbyhyZXN1bHQsIHRocmVzaG9sZCk7CiAgICAgIChfb3B0aW9uJG9uRmlyZWQgPSBvcHRpb24ub25GaXJlZCkgPT09IG51bGwgfHwgX29wdGlvbiRvbkZpcmVkID09PSB2b2lkIDAgfHwgX29wdGlvbiRvbkZpcmVkLmNhbGwob3B0aW9uKTsKICAgICAgaWYgKHJlc3VsdCA+PSB0aHJlc2hvbGQpIHsKICAgICAgICB0aGlzLnNvdW5kV2luLnBsYXkoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNvdW5kTG9zZS5wbGF5KCk7CiAgICAgIH0KICAgICAgdGhpcy5zaGlwLnJlbW92ZSgpOwogICAgICAoX29wdGlvbiRvbkZpbmlzaGVkID0gb3B0aW9uLm9uRmluaXNoZWQpID09PSBudWxsIHx8IF9vcHRpb24kb25GaW5pc2hlZCA9PT0gdm9pZCAwIHx8IF9vcHRpb24kb25GaW5pc2hlZC5jYWxsKG9wdGlvbik7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICB0aGlzLnNvdW5kRmlyZS5wbGF5KCk7CiAgICB9LCAxMDApOwogICAgdGhpcy5wbGF5RWZmZWN0KCk7CiAgICBjb25zdCB0YXJnZXRTY2FsZSA9IDAuMDE7CiAgICB0aGlzLnNoaXAuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7dGFyZ2V0U2NhbGV9KWA7CiAgICB0aGlzLnNoaXAuc3R5bGUubGVmdCA9IGAkeyh0aGlzLmNvbnRhaW5lci5vZmZzZXRXaWR0aCAtIDI2MiAqIHRhcmdldFNjYWxlKSAvIDJ9cHhgOwogICAgdGhpcy5zaGlwLnN0eWxlLmJvdHRvbSA9IGAke3RoaXMuY29udGFpbmVyLm9mZnNldEhlaWdodCAvIDJ9cHhgOwogICAgdGhpcy5zaGlwQmFzZS5zaG93RnJhbWUoMCk7CiAgICB0aGlzLnNoaXBGaXJlLnVucmVnaXN0ZXIoKTsKICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICB0aGlzLnJvbGxlci5yb2xsVG8ocmVzdWx0LCB0aHJlc2hvbGQpOwogICAgfSwgUk9MTF9ERUxBWSk7CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgdmFyIF9vcHRpb24kb25GaXJlZDI7CiAgICAgIChfb3B0aW9uJG9uRmlyZWQyID0gb3B0aW9uLm9uRmlyZWQpID09PSBudWxsIHx8IF9vcHRpb24kb25GaXJlZDIgPT09IHZvaWQgMCB8fCBfb3B0aW9uJG9uRmlyZWQyLmNhbGwob3B0aW9uKTsKICAgICAgaWYgKHJlc3VsdCA+PSB0aHJlc2hvbGQpIHsKICAgICAgICB0aGlzLnNvdW5kV2luLnBsYXkoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNvdW5kTG9zZS5wbGF5KCk7CiAgICAgIH0KICAgICAgdGhpcy5zaGlwLnJlbW92ZSgpOwogICAgICB0aGlzLnJlc2V0KG9wdGlvbi5vbkZpbmlzaGVkKTsKICAgIH0sIDEwMDApOwogIH0KICByZXNldChvbkZpbmlzaGVkKSB7CiAgICB0aGlzLnNoaXAuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7U0hJUF9TQ0FMRX0pYDsKICAgIHRoaXMuc2hpcC5zdHlsZS5sZWZ0ID0gYCR7KHRoaXMuY29udGFpbmVyLm9mZnNldFdpZHRoIC0gU0hJUF9TQ0FMRSAqIDEzOCkgLyAyfXB4YDsKICAgIHRoaXMuc2hpcC5zdHlsZS5ib3R0b20gPSBgMGA7CiAgICB0aGlzLnNoaXBCYXNlLnNob3dGcmFtZSgxKTsKICAgIHRoaXMuYW5pbWF0ZUxheWVyLmFwcGVuZENoaWxkKHRoaXMuc2hpcCk7CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgdGhpcy5zaGlwLnN0eWxlLmJvdHRvbSA9IGAkezI2MiAqIFNISVBfU0NBTEV9cHhgOwogICAgICB0aGlzLnNoaXBGaXJlLnJlZ2lzdGVyKCk7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIG9uRmluaXNoZWQgPT09IG51bGwgfHwgb25GaW5pc2hlZCA9PT0gdm9pZCAwIHx8IG9uRmluaXNoZWQoKTsKICAgICAgfSwgMTAwMCk7CiAgICB9LCAxMDApOwogIH0KICBhc3luYyBzZXRGYXN0TW9kZSh2YWx1ZSkgewogICAgaWYgKHZhbHVlID09PSB0aGlzLmZhc3RNb2RlKSByZXR1cm47CiAgICB0aGlzLmZhc3RNb2RlID0gdmFsdWU7CiAgICBpZiAodmFsdWUpIHsKICAgICAgdGhpcy5zaGlwLnJlbW92ZSgpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgIHRoaXMucmVzZXQocmVzb2x2ZSk7CiAgICAgIH0pOwogICAgfQogIH0KfQ=="},{"version":3,"names":["THREE","ROLL_DELAY","SHIP_SCALE","VIEW_DEEP","StarrySky","star","FrameSprite","ships","fires","frog","fireMp3","winMp3","loseMp3","Roll","dataCenter","Limbo","constructor","container","fastMode","stageWidth","offsetWidth","stageHeight","offsetHeight","scene","Scene","camera","PerspectiveCamera","position","z","renderer","WebGLRenderer","alpha","setSize","setPixelRatio","window","devicePixelRatio","stage","querySelector","appendChild","domElement","animateLayer","starMaterial","PointsMaterial","color","size","map","TextureLoader","load","transparent","starrySky","render","addShip","initEffect","roller","soundFire","Audio","volume","gameConfiguration","soundVolume","soundWin","soundLose","base","width","height","time","count","fire","left","top","ship","document","createElement","className","addToStage","register","shipBase","shipFire","showFrame","reset","scale","frogEffect","img","style","transform","bottom","start","stop","unregister","playEffect","play","remove","result","threshold","option","_option$onFired","_option$onFinished","display","rollTo","onFired","call","onFinished","setTimeout","targetScale","_option$onFired2","setFastMode","value","Promise","resolve"],"sources":["/Users/nuomi/Desktop/项目/fury-client/fury-client/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/fury-client/fury-client/src/games/limbo/game/index.tsx"],"sourcesContent":["import * as THREE from 'three';\nimport { ROLL_DELAY, SHIP_SCALE, VIEW_DEEP } from './preset';\nimport { StarrySky } from './StarrySky';\nimport star from '@/assets/game/limbo/star.png';\nimport FrameSprite from './FrameSprite';\nimport ships from '@/assets/game/limbo/ships.png';\nimport fires from '@/assets/game/limbo/fires.png';\nimport frog from '@/assets/game/limbo/expl.png';\n\nimport fireMp3 from '@/assets/game/limbo/limbo_fly.mp3';\nimport winMp3 from '@/assets/game/limbo/limbo_win.mp3';\nimport loseMp3 from '@/assets/game/limbo/losing.mp3';\nimport Roll from './Roll';\nimport dataCenter from '@/dataCenter';\n\nexport interface FireOption {\n  /**可以更新余额了 */\n  onFired?: () => void;\n  /**可以进行下一次请求了 */\n  onFinished?: () => void;\n}\n\nexport class Limbo {\n  private starrySky: StarrySky;\n  private ship!: HTMLElement;\n  private container: HTMLElement;\n  private animateLayer: HTMLElement;\n\n  private shipBase!: FrameSprite;\n  private shipFire!: FrameSprite;\n\n  private frogEffect!: FrameSprite;\n\n  private soundFire: HTMLAudioElement;\n  private soundWin: HTMLAudioElement;\n  private soundLose: HTMLAudioElement;\n\n  private roller: Roll;\n\n  /**这个要从本地环境读取 */\n  private fastMode = false;\n\n  constructor(container: HTMLElement) {\n    this.container = container;\n    const stageWidth = container.offsetWidth;\n    const stageHeight = container.offsetHeight;\n    const scene = new THREE.Scene();\n    const camera = new THREE.PerspectiveCamera(\n      75,\n      stageWidth / stageHeight,\n      0.1,\n      VIEW_DEEP,\n    );\n    camera.position.z = 5; // 将相机位置向前移动\n\n    const renderer = new THREE.WebGLRenderer({ alpha: true });\n    renderer.setSize(stageWidth, stageHeight);\n    renderer.setPixelRatio(window.devicePixelRatio);\n\n    const stage = container.querySelector('#limbo-stage');\n    stage!.appendChild(renderer.domElement);\n\n    this.animateLayer = container.querySelector(\n      '#limbo-animate-layer',\n    ) as HTMLDivElement;\n\n    const starMaterial = new THREE.PointsMaterial({\n      color: 0xffffff,\n      size: 2,\n      map: new THREE.TextureLoader().load(star),\n      transparent: true,\n    });\n\n    this.starrySky = new StarrySky(scene, starMaterial, () => {\n      renderer.render(scene, camera);\n    });\n\n    this.addShip();\n    this.initEffect();\n\n    this.roller = new Roll(this.animateLayer);\n\n    this.soundFire = new Audio(fireMp3);\n    this.soundFire.volume = dataCenter.gameConfiguration.soundVolume\n    this.soundWin = new Audio(winMp3);\n    this.soundWin.volume = dataCenter.gameConfiguration.soundVolume\n    this.soundLose = new Audio(loseMp3);\n    this.soundLose.volume = dataCenter.gameConfiguration.soundVolume\n  }\n  private addShip() {\n    const base = new FrameSprite(ships, {\n      width: 138,\n      height: 262,\n      time: 100,\n      count: 2,\n    });\n    const fire = new FrameSprite(fires, {\n      width: 104.2,\n      height: 105,\n      time: 50,\n      count: 10,\n      left: (138 - 104.2) / 2,\n      top: 262 - 105 - 40,\n    });\n    const ship = document.createElement('div');\n    ship.className = 'ship';\n    base.addToStage(ship);\n    fire.addToStage(ship);\n    fire.register();\n    this.shipBase = base;\n    this.shipFire = fire;\n\n    this.shipBase.showFrame(1);\n\n    this.animateLayer.appendChild(ship);\n    this.ship = ship;\n\n    this.reset();\n  }\n  private initEffect() {\n    const width = 3883 / 13;\n    const scale = 0.6;\n    this.frogEffect = new FrameSprite(frog, {\n      width,\n      height: 300,\n      time: 50,\n      count: 13,\n    });\n    this.frogEffect.img.style.transform = `scale(${scale})`;\n    // 这里直接用的图片，图片似乎是按照中心来缩放的\n    this.frogEffect.img.style.left = `${(this.container.offsetWidth - width - 4) / 2\n      }px`;\n    this.frogEffect.img.style.bottom = `-90px`;\n  }\n  start() {\n    this.starrySky.register();\n    return this;\n  }\n  stop() {\n    this.starrySky.unregister();\n  }\n  playEffect() {\n    this.animateLayer.appendChild(this.frogEffect.img);\n    this.frogEffect.play(1, () => {\n      this.frogEffect.img.remove();\n    });\n  }\n  /**\n   *\n   * @param result 后端给的结果\n   * @param threshold 获胜的阈值\n   * @param option 回调的option\n   */\n  fire(result: number, threshold: number, option: FireOption) {\n    if (this.fastMode) {\n      this.roller.display(result, threshold);\n      this.roller.rollTo(result, threshold);\n      option.onFired?.();\n      if (result >= threshold) {\n        this.soundWin.play();\n      } else {\n        this.soundLose.play();\n      }\n      this.ship.remove();\n      option.onFinished?.();\n      return;\n    }\n    setTimeout(() => {\n      this.soundFire.play();\n    }, 100);\n    this.playEffect();\n    const targetScale = 0.01;\n    this.ship.style.transform = `scale(${targetScale})`;\n    this.ship.style.left = `${(this.container.offsetWidth - 262 * targetScale) / 2\n      }px`;\n    this.ship.style.bottom = `${this.container.offsetHeight / 2}px`;\n    this.shipBase.showFrame(0);\n    this.shipFire.unregister();\n    setTimeout(() => {\n      this.roller.rollTo(result, threshold);\n    }, ROLL_DELAY);\n    setTimeout(() => {\n      option.onFired?.();\n      if (result >= threshold) {\n        this.soundWin.play();\n      } else {\n        this.soundLose.play();\n      }\n      this.ship.remove();\n      this.reset(option.onFinished);\n    }, 1000);\n  }\n\n  private reset(onFinished?: () => void) {\n    this.ship.style.transform = `scale(${SHIP_SCALE})`;\n    this.ship.style.left = `${(this.container.offsetWidth - SHIP_SCALE * 138) / 2\n      }px`;\n    this.ship.style.bottom = `0`;\n    this.shipBase.showFrame(1);\n    this.animateLayer.appendChild(this.ship);\n    setTimeout(() => {\n      this.ship.style.bottom = `${262 * SHIP_SCALE}px`;\n      this.shipFire.register();\n      setTimeout(() => {\n        onFinished?.();\n      }, 1000);\n    }, 100);\n  }\n  async setFastMode(value: boolean) {\n    if (value === this.fastMode) return;\n    this.fastMode = value;\n    if (value) {\n      this.ship.remove();\n    } else {\n      return new Promise<void>((resolve) => {\n        this.reset(resolve);\n      });\n    }\n  }\n}\n"],"mappings":"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"}]}