{"remainingRequest":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/babel-loader/lib/index.js!/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/ts-loader/index.js??ref--15-2!/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/concept/fury-client/src/games/limbo/game/FrameSprite.ts","dependencies":[{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/src/games/limbo/game/FrameSprite.ts","mtime":1716171553010},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/babel.config.js","mtime":1716171552917},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/cache-loader/dist/cjs.js","mtime":1716171608994},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/babel-loader/lib/index.js","mtime":1716171609486},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/ts-loader/index.js","mtime":1716171609531},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js","mtime":1716171609105}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgVXBkYXRlciB9IGZyb20gJ0AvbWFuYWdlci9GcmFtZU1hbmFnZXInOwpleHBvcnQgZGVmYXVsdCBjbGFzcyBGcmFtZVNwcml0ZSBleHRlbmRzIFVwZGF0ZXIgewogIGNvbnN0cnVjdG9yKHJlcywgb3B0aW9uKSB7CiAgICBzdXBlcigpOwogICAgdGhpcy5jdXJyZW50RnJhbWUgPSAtMTsKICAgIHRoaXMucGxheUZyYW1lcyA9IDA7CiAgICB0aGlzLm9wdGlvbiA9IG9wdGlvbjsKICAgIHRoaXMuaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7CiAgICB0aGlzLmltZy5jbGFzc05hbWUgPSAnc3ByaXRlJzsKICAgIHRoaXMuaW1nLndpZHRoID0gdGhpcy5vcHRpb24ud2lkdGg7CiAgICB0aGlzLmltZy5oZWlnaHQgPSB0aGlzLm9wdGlvbi5oZWlnaHQ7CiAgICB0aGlzLmltZy5zcmMgPSByZXM7CiAgICB0aGlzLmltZy5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7CiAgICBpZiAob3B0aW9uLmxlZnQgIT09IHVuZGVmaW5lZCkgewogICAgICB0aGlzLmltZy5zdHlsZS5sZWZ0ID0gYCR7b3B0aW9uLmxlZnR9cHhgOwogICAgfQogICAgaWYgKG9wdGlvbi50b3AgIT09IHVuZGVmaW5lZCkgewogICAgICB0aGlzLmltZy5zdHlsZS50b3AgPSBgJHtvcHRpb24udG9wfXB4YDsKICAgIH0KICB9CiAgYWRkVG9TdGFnZShjb250YWluZXIpIHsKICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmltZyk7CiAgICB0aGlzLnNob3dGcmFtZSgwKTsKICB9CiAgc2hvd0ZyYW1lKGluZGV4KSB7CiAgICBpZiAodGhpcy5jdXJyZW50RnJhbWUgPT09IGluZGV4KSByZXR1cm47CiAgICB0aGlzLmN1cnJlbnRGcmFtZSA9IGluZGV4OwogICAgdGhpcy5pbWcuc3R5bGUub2JqZWN0UG9zaXRpb24gPSBgLSR7aW5kZXggKiB0aGlzLm9wdGlvbi53aWR0aH1weCAwYDsKICB9CiAgcmVnaXN0ZXIoKSB7CiAgICB0aGlzLnNob3dGcmFtZSgwKTsKICAgIHRoaXMucGxheUZyYW1lcyA9IDk5OTk5OTk5OTk5OwogICAgc3VwZXIucmVnaXN0ZXIoKTsKICB9CiAgcmVtb3ZlKCkgewogICAgdGhpcy5pbWcucmVtb3ZlKCk7CiAgICB0aGlzLnVucmVnaXN0ZXIoKTsKICB9CiAgdXBkYXRlKGVzdCkgewogICAgc3VwZXIudXBkYXRlKGVzdCk7CiAgICBjb25zdCBmcmFtZUR1cmF0aW9uID0gdGhpcy5vcHRpb24udGltZTsgLy8g5q+P5bin55qE5oyB57ut5pe26Ze077yI5q+r56eS77yJCiAgICBjb25zdCBmcmFtZUluZGV4ID0gTWF0aC5mbG9vcih0aGlzLmVzcFRpbWUgLyBmcmFtZUR1cmF0aW9uKSAlIHRoaXMub3B0aW9uLmNvdW50OwogICAgaWYgKHRoaXMuY3VycmVudEZyYW1lID09PSBmcmFtZUluZGV4KSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHRoaXMuY3VycmVudEZyYW1lID0gZnJhbWVJbmRleDsKICAgIHRoaXMuaW1nLnN0eWxlLm9iamVjdFBvc2l0aW9uID0gYC0ke2ZyYW1lSW5kZXggKiB0aGlzLm9wdGlvbi53aWR0aH1weCAwYDsKICAgIHRoaXMucGxheUZyYW1lcy0tOwogICAgaWYgKHRoaXMucGxheUZyYW1lcyA8PSAwKSB7CiAgICAgIHZhciBfdGhpcyRvblBsYXlDb21wbGV0ZTsKICAgICAgdGhpcy51bnJlZ2lzdGVyKCk7CiAgICAgIChfdGhpcyRvblBsYXlDb21wbGV0ZSA9IHRoaXMub25QbGF5Q29tcGxldGUpID09PSBudWxsIHx8IF90aGlzJG9uUGxheUNvbXBsZXRlID09PSB2b2lkIDAgfHwgX3RoaXMkb25QbGF5Q29tcGxldGUuY2FsbCh0aGlzKTsKICAgIH0KICB9CiAgcGxheSh0aW1lcyA9IDEsIGNhbGxiYWNrKSB7CiAgICB0aGlzLm9uUGxheUNvbXBsZXRlID0gY2FsbGJhY2s7CiAgICB0aGlzLnNob3dGcmFtZSgwKTsKICAgIHRoaXMucGxheUZyYW1lcyA9IHRoaXMub3B0aW9uLmNvdW50ICogdGltZXM7CiAgICBzdXBlci5yZWdpc3RlcigpOwogIH0KfQ=="},{"version":3,"names":["Updater","FrameSprite","constructor","res","option","currentFrame","playFrames","img","document","createElement","className","width","height","src","style","position","left","undefined","top","addToStage","container","appendChild","showFrame","index","objectPosition","register","remove","unregister","update","est","frameDuration","time","frameIndex","Math","floor","espTime","count","_this$onPlayComplete","onPlayComplete","call","play","times","callback"],"sources":["/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/eslint-loader/index.js??ref--14-0!/Users/nuomi/Desktop/项目/concept/fury-client/src/games/limbo/game/FrameSprite.ts"],"sourcesContent":["import { Updater } from '@/manager/FrameManager';\n\nexport interface FrameSpiteOption {\n  width: number;\n  height: number;\n  time: number;\n  count: number;\n  top?: number;\n  left?: number;\n}\n\nexport default class FrameSprite extends Updater {\n  public img: HTMLImageElement;\n  private currentFrame = -1;\n  private option: FrameSpiteOption;\n  private playFrames = 0;\n  private onPlayComplete?: () => void;\n\n  constructor(res: string, option: FrameSpiteOption) {\n    super();\n    this.option = option;\n    this.img = document.createElement('img');\n    this.img.className = 'sprite';\n    this.img.width = this.option.width;\n    this.img.height = this.option.height;\n    this.img.src = res;\n    this.img.style.position = 'absolute';\n    if (option.left !== undefined) {\n      this.img.style.left = `${option.left}px`;\n    }\n    if (option.top !== undefined) {\n      this.img.style.top = `${option.top}px`;\n    }\n  }\n  addToStage(container: HTMLElement) {\n    container.appendChild(this.img);\n    this.showFrame(0);\n  }\n  showFrame(index: number) {\n    if (this.currentFrame === index) return;\n    this.currentFrame = index;\n    this.img.style.objectPosition = `-${index * this.option.width}px 0`;\n  }\n  register(): void {\n    this.showFrame(0);\n    this.playFrames = 99999999999;\n    super.register();\n  }\n  remove() {\n    this.img.remove();\n    this.unregister();\n  }\n  update(est: number): void {\n    super.update(est);\n    const frameDuration = this.option.time; // 每帧的持续时间（毫秒）\n    const frameIndex =\n      Math.floor(this.espTime / frameDuration) % this.option.count;\n    if (this.currentFrame === frameIndex) {\n      return;\n    }\n    this.currentFrame = frameIndex;\n    this.img.style.objectPosition = `-${frameIndex * this.option.width}px 0`;\n    this.playFrames--;\n    if (this.playFrames <= 0) {\n      this.unregister();\n      this.onPlayComplete?.();\n    }\n  }\n  play(times = 1, callback?: () => void) {\n    this.onPlayComplete = callback;\n    this.showFrame(0);\n    this.playFrames = this.option.count * times;\n    super.register();\n  }\n}\n"],"mappings":"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"}]}