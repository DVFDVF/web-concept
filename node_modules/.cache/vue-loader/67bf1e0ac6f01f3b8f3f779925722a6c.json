{"remainingRequest":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/nuomi/Desktop/项目/concept/fury-client/src/views/chats/chatsArea/ChatsArea.vue?vue&type=style&index=0&id=48aaae03&lang=less&scoped=true","dependencies":[{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/src/views/chats/chatsArea/ChatsArea.vue","mtime":1716171553022},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/css-loader/dist/cjs.js","mtime":1716171609309},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1716171609792},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/postcss-loader/src/index.js","mtime":1716171609472},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/less-loader/dist/cjs.js","mtime":1716171609345},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/cache-loader/dist/cjs.js","mtime":1716171608994},{"path":"/Users/nuomi/Desktop/项目/concept/fury-client/node_modules/vue-loader-v16/dist/index.js","mtime":1716171609468}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5tYWluIHsKICBmbGV4OiAxOwogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICBvdmVyZmxvdzogaGlkZGVuOwp9Ci5jb250ZW50IHsKICBmbGV4OiAxOwogIGhlaWdodDogMTAwJTsKICBvdmVyZmxvdy15OiBhdXRvOwogIHBhZGRpbmctYm90dG9tOiAxMHB4Owp9Ci5zY3JvbGwtaW50ZXJhY3Rpb24tYnV0dG9uLnZpc2libGUgewogIG9wYWNpdHk6IDE7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDApOwogIHZpc2liaWxpdHk6IHZpc2libGU7Cn0KLnNjcm9sbC1pbnRlcmFjdGlvbi1idXR0b24gewogIGJhY2tncm91bmQtY29sb3I6ICMzYzQ4NWM7CiAgYm9yZGVyLXJhZGl1czogNTAlOwogIGJvdHRvbTogMTZweDsKICBoZWlnaHQ6IDQwcHg7CiAgbWluLXdpZHRoOiA0MHB4OwogIG9wYWNpdHk6IDA7CiAgcGFkZGluZzogMDsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgcmlnaHQ6IDE0cHg7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDEwcHgpOwogIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4xcyBlYXNlLWluLW91dCwgdHJhbnNmb3JtIDAuMXMgZWFzZS1pbi1vdXQsCiAgICBvcGFjaXR5IDAuMXMgZWFzZS1pbi1vdXQ7CiAgdmlzaWJpbGl0eTogaGlkZGVuOwogIHdpbGwtY2hhbmdlOiBiYWNrZ3JvdW5kLWNvbG9yLCB0cmFuc2Zvcm0sIG9wYWNpdHk7CiAgei1pbmRleDogMzsKfQouc2Nyb2xsLWludGVyYWN0aW9uLWJ1dHRvbiAuYW1vdW50IHsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjMWJiODNkOwogIGJvcmRlci1yYWRpdXM6IDUwcHg7CiAgY29sb3I6ICNmZmY7CiAgZm9udC1zaXplOiAxMnB4OwogIGZvbnQtd2VpZ2h0OiA2MDA7CiAgaGVpZ2h0OiAyMHB4OwogIGxlZnQ6IDUwJTsKICBsZXR0ZXItc3BhY2luZzogLTAuMDJlbTsKICBtaW4td2lkdGg6IDIwcHg7CiAgcGFkZGluZy1sZWZ0OiA1cHg7CiAgcGFkZGluZy1yaWdodDogNXB4OwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDA7CiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7CiAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjFzIGVhc2UtaW4tb3V0Owp9Cgouc2Nyb2xsLWludGVyYWN0aW9uLWJ1dHRvbjpob3ZlciB7CiAgYmFja2dyb3VuZC1jb2xvcjogIzU1NjU3ZTsKfQo="},{"version":3,"sources":["/Users/nuomi/Desktop/项目/concept/fury-client/src/views/chats/chatsArea/ChatsArea.vue"],"names":[],"mappings":"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","file":"/Users/nuomi/Desktop/项目/concept/fury-client/src/views/chats/chatsArea/ChatsArea.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"main\">\n    <div class=\"content\" ref=\"scrollContainer\" @scroll=\"handleScroll\">\n      <!-- <ChatsCenterIcon></ChatsCenterIcon> -->\n      <div class=\"col-center\" v-show=\"isLodding\">\n        <ChatsLodding style=\"width: 20px; height: 20px\"></ChatsLodding>\n      </div>\n      <ChatsCenter\n        v-for=\"item in messageList\"\n        :key=\"item.id\"\n        :msg-item=\"item\"\n        @replyClick=\"replyClick\"\n      ></ChatsCenter>\n    </div>\n    <button\n      class=\"scroll-interaction-button center visible\"\n      @click=\"scrollToButtom()\"\n      v-show=\"scrollBtn\"\n    >\n      <svg\n        width=\"10\"\n        height=\"6\"\n        viewBox=\"0 0 10 6\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <path\n          d=\"M1 1L5 5L9 1\"\n          stroke=\"white\"\n          stroke-width=\"2\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n        ></path>\n      </svg>\n      <!-- <span class=\"amount center unread-amount\">9</span> -->\n    </button>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { UserBriefRespItem } from '@/api/protocol';\nimport dataCenter from '@/dataCenter';\nimport { ChatData } from '@/dataCenter/chatRoom';\nimport { defineComponent, nextTick, ref, watch } from 'vue';\nimport ChatsLodding from '../ChatsLodding.vue';\nimport ChatsCenter from './ChatsCenter.vue';\nexport default defineComponent({\n  data() {\n    return {\n      isLodding: false,\n      scrollBtn: false,\n      isEmpty: false,\n    };\n  },\n  methods: {\n    scrollToButtom() {\n      // 使用$refs来获取元素引用\n      const scrollContainer = this.$refs.scrollContainer as HTMLElement;\n      if (scrollContainer) {\n        // 滚动到底部\n        this.$nextTick(() => {\n          scrollContainer.scrollTop = scrollContainer.scrollHeight;\n        });\n      }\n    },\n    handleScroll() {\n      // 如何加载正在进行，不再请求刷新\n      if (this.isLodding || this.isEmpty) return;\n      const scrollContainer = this.$refs.scrollContainer as HTMLElement;\n      if (!scrollContainer) return;\n      const scrollHeight = scrollContainer.scrollHeight;\n      //如果超过一个页面区域，显示滚动按钮\n      if (\n        scrollContainer.scrollTop + scrollContainer.clientHeight * 2 <\n        scrollHeight\n      ) {\n        this.scrollBtn = false;\n      } else {\n        this.scrollBtn = false;\n      }\n      if (scrollContainer.scrollTop <= 0) {\n        if (this.messageList) {\n          //如果大于两百条就不要请求数据了\n          if (this.messageList.length >= 200) {\n            this.isLodding = false;\n            return;\n          }\n        }\n        // 检查滚动位置是否在页面顶部\n        this.isLodding = true;\n        dataCenter.chatRoom\n          .pullHistory()\n          .then(() => {\n            this.$nextTick(() => {\n              const nowScrollPosition = scrollContainer.scrollHeight;\n              scrollContainer.scrollTop = nowScrollPosition - scrollHeight;\n            });\n          })\n          .finally(() => {\n            this.isLodding = false;\n            if (scrollContainer.scrollTop <= 23) {\n              this.isEmpty = true;\n            }\n          });\n      }\n    },\n    replyClick(msgItem: ChatData, userBrief: UserBriefRespItem) {\n      this.$emit('replyClick', msgItem, userBrief);\n    },\n  },\n  setup() {\n    const scrollContainer = ref<HTMLElement | null>(null);\n    watch(\n      () => dataCenter.chatRoom.list.length,\n      () => {\n        nextTick(() => {\n          if (scrollContainer.value) {\n            let scroll = scrollContainer.value as HTMLElement;\n            if (!scroll) return;\n            const scrollHeight = scroll.scrollHeight;\n            if (scroll) {\n              //滚动多了，不再滚动\n              if (\n                //超过一页不再自动滚动到底部\n                scroll.scrollTop + scroll.clientHeight * 2 <\n                scrollHeight\n              )\n                return;\n              scroll.scrollTop = scrollHeight;\n            }\n          }\n        });\n      },\n    );\n    return {\n      scrollContainer,\n    };\n  },\n  components: { ChatsCenter, ChatsLodding },\n  props: {\n    messageList: {\n      type: Object as () => ChatData[],\n    },\n  },\n});\n</script>\n\n<style lang=\"less\" scoped>\n.main {\n  flex: 1;\n  position: relative;\n  overflow: hidden;\n}\n.content {\n  flex: 1;\n  height: 100%;\n  overflow-y: auto;\n  padding-bottom: 10px;\n}\n.scroll-interaction-button.visible {\n  opacity: 1;\n  transform: translateY(0);\n  visibility: visible;\n}\n.scroll-interaction-button {\n  background-color: #3c485c;\n  border-radius: 50%;\n  bottom: 16px;\n  height: 40px;\n  min-width: 40px;\n  opacity: 0;\n  padding: 0;\n  position: absolute;\n  right: 14px;\n  transform: translateY(10px);\n  transition: background-color 0.1s ease-in-out, transform 0.1s ease-in-out,\n    opacity 0.1s ease-in-out;\n  visibility: hidden;\n  will-change: background-color, transform, opacity;\n  z-index: 3;\n}\n.scroll-interaction-button .amount {\n  background-color: #1bb83d;\n  border-radius: 50px;\n  color: #fff;\n  font-size: 12px;\n  font-weight: 600;\n  height: 20px;\n  left: 50%;\n  letter-spacing: -0.02em;\n  min-width: 20px;\n  padding-left: 5px;\n  padding-right: 5px;\n  position: absolute;\n  top: 0;\n  transform: translate(-50%, -50%);\n  transition: background-color 0.1s ease-in-out;\n}\n\n.scroll-interaction-button:hover {\n  background-color: #55657e;\n}\n</style>\n"]}]}